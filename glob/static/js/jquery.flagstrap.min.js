!(function(p) {
  var g = {
      buttonSize: "btn-md",
      buttonType: "btn-default",
      labelMargin: "10px",
      scrollable: !0,
      scrollableHeight: "250px",
      placeholder: { value: "", text: "" }
    },
    u = { FR: "Français", DE: "Deutsch", PT: "Português", GB: "English" };
  (p.flagStrap = function(t, e, a) {
    var r = this,
      i = (function(t) {
        var e = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split(
          ""
        );
        t || (t = Math.floor(Math.random() * e.length));
        for (var a = "", s = 0; s < t; s++)
          a += e[Math.floor(Math.random() * e.length)];
        return a;
      })(8);
    (r.countries = {}),
      (r.selected = { value: null, text: null }),
      (r.settings = { inputName: "country-" + i });
    var s = p(t),
      n = "flagstrap-" + i,
      o = "#" + n;
    r.init = function() {
      (r.countries = u),
        (r.countries = u),
        (r.settings = p.extend({}, g, e, s.data())),
        void 0 !== r.settings.countries && (r.countries = r.settings.countries),
        void 0 !== r.settings.inputId &&
          ((n = r.settings.inputId), (o = "#" + n)),
        s
          .addClass("flagstrap")
          .append(l)
          .append(d)
          .append(c),
        void 0 !== r.settings.onSelect &&
          r.settings.onSelect instanceof Function &&
          p(o).change(function(t) {
            e.onSelect(p(this).val(), this);
          }),
        p(o).hide();
    };
    var l = function() {
        var s = p("<select/>")
          .attr("id", n)
          .attr("name", r.settings.inputName);
        return (
          p.each(r.countries, function(t, e) {
            var a = { value: t };
            void 0 !== r.settings.selectedCountry &&
              r.settings.selectedCountry === t &&
              ((a = { value: t, selected: "selected" }),
              (r.selected = { value: t, text: e })),
              s.append(p("<option>", a).text(e));
          }),
          !1 !== r.settings.placeholder &&
            s.prepend(
              p("<option>", {
                value: r.settings.placeholder.value,
                text: r.settings.placeholder.text
              })
            ),
          s
        );
      },
      d = function() {
        var t = p(o)
            .find("option")
            .first()
            .text(),
          e = p(o)
            .find("option")
            .first()
            .val();
        if (
          ((t = r.selected.text || t),
          (e = r.selected.value || e) !== r.settings.placeholder.value)
        )
          {        

            var a = p("<i/>")
            .addClass("flagstrap-icon flagstrap-" + e.toLowerCase())
            .css("margin-bottom", "2px")
            .css("margin-right", r.settings.labelMargin)
            .css("margin-left", "12px");}
        else {
          var lang = window.location['pathname'].slice(1,3);
          lang=='en'&&(lang='gb')
          a = p("<i/>")
          .addClass("flagstrap-icon flagstrap-" + lang)
          .css("margin-bottom", "2px")
          .css("margin-right", r.settings.labelMargin)
          .css("margin-left", "12px");
        }
        var s = p("<span/>")
            .addClass("flagstrap-selected-" + i)
            .html(a)
            .append(t),
          n = p("<button/>")
            .attr("type", "button")
            .attr("data-toggle", "dropdown")
            .css("color", "#fff")
            .css("font-family", "Montserrat")
            .css("font-size", "20px")
            .css("font-weight", "400")
            .css("box-shadow", "3px 3px 5px 6px rgba(204, 204, 204, 0)")
            .css("margin-bottom", "23px")
            .attr("id", "flagstrap-drop-down-" + i)
            .addClass(
              "btn " +
                r.settings.buttonType +
                " " +
                r.settings.buttonSize +
                " dropdown-toggle"
            )
            .attr("onClick", '$( ".dropdown-menu" ).toggle()')
            .html(s);
        return (
          p("<span/>")
            .addClass("caret")
            .css("margin-left", r.settings.labelMargin)
            .insertAfter(s),
          n
        );
      },
      c = function() {
        var l = p("<ul/>")
          .attr("id", "flagstrap-drop-down-" + i + "-list")
          .attr("aria-labelled-by", "flagstrap-drop-down-" + i)
          .attr("onClick", '$( ".dropdown-menu" ).toggle()')
          .addClass("dropdown-menu");
        return (
          r.settings.scrollable &&
            l
              .css("height", "auto")
              .css("max-height", r.settings.scrollableHeight)
              .css("background-color", "#00000080")
              .css("color", "#fff")
              .css("overflow-x", "hidden"),
          p(o)
            .find("option")
            .each(function() {
              var t = p(this).text(),
                e = p(this).val();
              if (e !== r.settings.placeholder.value)
                var a = p("<i/>")
                  .addClass("flagstrap-icon flagstrap-" + e.toLowerCase())
                  .css("margin-right", r.settings.labelMargin)
                  .css("margin-bottom", "2px")
                  .css("margin-left", "12px");
              else a = null;

              if (e.toLowerCase() == "gb") {
                e = "EN";
              }

              var s = p("<a/>")
                  .attr("data-val", p(this).val())
                  .attr("href", "../../../" + e.toLowerCase()+'/site')
                  .addClass("dropdown-link")
                  .html(a)
                  .append(t)
                  .on("click", function(t) {
                    p(o).val(p(this).data("val")),
                      p(o).trigger("change"),
                      p(".flagstrap-selected-" + i).html(p(this).html()),
                      t.preventDefault();
                  }),
                n = p("<li/>").prepend(s);
              l.append(n);
            }),
          l
        );
      };
    r.init();
  }),
    (p.fn.flagStrap = function(e) {
      return this.each(function(t) {
        void 0 === p(this).data("flagStrap") &&
          p(this).data("flagStrap", new p.flagStrap(this, e, t));
      });
    });
})(jQuery);
